# Laboratoire 14

Un [projet de dÃ©part](../../static/files/labo14.zip) Angular vous est fourni pour ce labo. Vous devrez crÃ©er le projet ASP.NET Core Web API vous-mÃªmes cela dit.

## ğŸ«ƒ Ma premiÃ¨re Web API

### 1 - CrÃ©ation du projet

[ğŸ’¡](/cours/rencontre7.2#-serveur-web-api-simple) CrÃ©ez un projet ASP.NET Core Web API avec la version .NET 8 nommÃ© `labo14_serveur`.

Suivez toutes les Ã©tapes des notes de cours bÃªtement et arrÃªtez vous juste avant la **crÃ©ation du modÃ¨le**.

### 2 - CrÃ©ation d'un modÃ¨le

[ğŸ’¡](/cours/rencontre7.2#-modÃ¨le) CrÃ©ez un modÃ¨le `Item.cs` avec les propriÃ©tÃ©s suivantes :

* Id (int) -> Ex. 2
* Name (string) -> Ex. "Silencieux dâ€™autmobile"
* Value (int) -> Ex. 80

### 3 - CrÃ©ation d'un contrÃ´leur

[ğŸ’¡](/cours/rencontre7.2#-contrÃ´leur) CrÃ©ez un contrÃ´leur avec des actions auto-gÃ©nÃ©rÃ©es pour ce modÃ¨le.

ExÃ©cutez ensuite votre application et vÃ©rifiez que Swagger affiche les informations des requÃªtes de ce nouveau contrÃ´leur. (Lâ€™ordre des requÃªtes pourrait Ãªtre diffÃ©rent)

<center>![Interface Swagger](../../static/img/labo14/swagger1.png)</center>

## ğŸš— Faire fausse route

Nous allons modifier quelques routes dans `ItemsController`.

### 4 - Utiliser une rÃ¨gle globale

[ğŸ’¡](/cours/rencontre7.2#-rÃ¨gles-globales) Changez la rÃ¨gle globale de routage de votre contrÃ´leur pour que le nom des actions soit inclus dans les URL de requÃªte.

### 5 - Utiliser une rÃ¨gle spÃ©cifique

[ğŸ’¡](/cours/rencontre7.2#-rÃ¨gles-par-action) Ajoutez une rÃ¨gle spÃ©cifique Ã  lâ€™action `Delete` pour que lâ€™url de requÃªte soit `localhost:port/api/destroy`.

De plus, changez la mÃ©thode de l'action pour que ce soit `POST` plutÃ´t que `DELETE`. (Le code Ã  l'intÃ©rieur de lâ€™action doit rester identique, cela servira encore Ã  supprimer un Item de la base de donnÃ©es. On sâ€™amuse juste Ã  changer le type de mÃ©thode / requÃªte pour se rendre compte quâ€™on peut en faire ce quâ€™on veut)

Si vous exÃ©cutez Ã  nouveau le serveur, vous devriez avoir ceci :

<center>![Interface Swagger](../../static/img/labo14/swagger2.png)</center>

## ğŸ’¿ SQL c'est plate smh

### 6 - GÃ©nÃ©rer la base de donnÃ©es

[ğŸ’¡](/cours/rencontre7.2#-crÃ©er-la-base-de-donnÃ©es) Faites toutes les Ã©tapes nÃ©cessaires pour gÃ©nÃ©rer une base de donnÃ©es qui pourra contenir des objets de type `Item`. Remerciez au passage `Entity Framework` pour l'opportunitÃ© de ne pas Ã©crire la moindre ligne de SQL aujourd'hui.

## ğŸ–¥ Angular ? Ã‡a ne me dit rien

Faites le nÃ©cessaire pour ouvrir et exÃ©cuter le projet Angular fourni. La classe `Item` existe dÃ©jÃ  dans le projet Angular. Si vous avez bien respectÃ© les noms indiquÃ©s pour la classe `Item` cÃ´tÃ© serveur, tout devrait bien fonctionner.

### 7 - CrÃ©er 5 requÃªtes

Vous aurez seulement Ã  modifier la classe `ItemService`. Tout le reste est dÃ©jÃ  mis en place.

Pour les implÃ©mentations qui suivent, nâ€™hÃ©sitez pas Ã  jeter un coup dâ€™Å“il Ã  **lâ€™interface Swagger** en exÃ©cutant votre serveur pour savoir quelles requÃªtes utiliser.

[ğŸ’¡](/cours/rencontre7.2#-get) ImplÃ©mentez `GetAll`. Comme `Post` n'est pas encore implÃ©mentÃ©, c'est normal que l'objet JSON retournÃ© par le serveur soit une liste **vide**. Dans tous les cas, retournez la liste d'items obtenue.

<center>![GetAll](../../static/img/labo14/getAll.png)</center>

<hr/>

[ğŸ’¡](/cours/rencontre7.2#-post) En utilisant la `value` et le `name` spÃ©cifiÃ©s par lâ€™utilisateur, implÃ©mentez la requÃªte `Post`.

<center>![Post](../../static/img/labo14/post.png)</center>

<hr/>

[ğŸ’¡](/cours/rencontre7.2#-get) En utilisant lâ€™`id` spÃ©cifiÃ© par lâ€™utilisateur, implÃ©mentez la requÃªte `Get` et retournez l'item obtenu.

<center>![Get](../../static/img/labo14/get.png)</center>

<hr/>

[ğŸ’¡](/cours/rencontre7.2#-put) En utilisant l'`id`, la `value` et le `name` spÃ©cifiÃ©s par l'utilisteur, implÃ©menter la requÃªte `Put` qui permettra de modifier un item existant dans la base de donnÃ©es.

<center>![Put](../../static/img/labo14/put.png)</center>

<hr/>

[ğŸ’¡](/cours/rencontre7.2#-delete) ImplÃ©mentez la requÃªte `Delete` en utilisant l'`id` fourni par l'utilisateur.

* Nâ€™oubliez pas quâ€™on a donnÃ© le type POST Ã  cette requÃªte dans notre Web API. Ã‡a veut dire quâ€™on est obligÃ©s de fournir un **corps** Ã  la requÃªte HTTP. 
* Cela dit, nous nâ€™avons rien de pertinent Ã  insÃ©rer dans le **corps** (Il suffit de mettre lâ€™`id` de lâ€™item Ã  supprimer dans lâ€™URL...), donc mettez Â« `null` Â» comme corps. 
* Bien entendu, câ€™est normal que Ã§a ne fonctionne pas si lâ€™`id` spÃ©cifiÃ© nâ€™existe pas dans la base de donnÃ©es.

<center>![Delete](../../static/img/labo14/delete.png)</center>

Bravo ! Vous avez rÃ©alisÃ© une application Web qui respecte l'architecture `REST` ! Allez maintenant vous `reposer`.